---
title: "Lichess4545 stats homepage"
output: md_document
date: "Last updated: `r format(Sys.time(), '%B %Y')`"
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

if (!require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse, knitr)

```

A repository of statistics related to the Lichess4545 online chess leagues.

## Season statistics and awards

```{r season_reports_tbl}

# Identify all seasons for which stats reports have been compiled 

# 4545
completed_4545 <- list.files(path = "reports/", pattern = "^stats_4545(.*)\\.html$") 
any_4545 <- ifelse(length(completed_4545) > 0, T, F)
if(length(completed_4545) > 0){
  completed_4545 <- completed_4545 %>% 
    str_remove_all("stats_4545_s") %>% 
    str_remove_all("\\.html") %>% 
    sort(decreasing = T) %>% 
    paste0("[Season ", ., "]", "(https://rahulan-c.github.io/lichess4545-stats/reports/stats_4545_s", ., ".html)")
}

# LW Open
completed_lwopen <- list.files(path = "reports/", pattern = "^stats_lwopen(.*)\\.html$")
any_lwopen <- ifelse(length(completed_lwopen) > 0, T, F)
if(length(completed_lwopen) > 0){
  completed_lwopen <- completed_lwopen %>% 
    str_remove_all("stats_lwopen_s") %>% 
    str_remove_all("\\.html") %>% 
    sort(decreasing = T) %>% 
    paste0("[Season ", ., "]", "(https://rahulan-c.github.io/lichess4545-stats/reports/stats_lwopen_s", ., ".html)")
}

# LW U1800
completed_lwu1800 <- list.files(path = "reports/", pattern = "^stats_lwu1800(.*)\\.html$")
any_lwu1800 <- ifelse(length(completed_lwu1800) > 0, T, F)
if(length(completed_lwu1800) > 0){
 completed_lwu1800 <- completed_lwu1800 %>%  
   str_remove_all("stats_lwu1800_s") %>% 
   str_remove_all("\\.html") %>% 
   sort(decreasing = T) %>% 
   paste0("[Season ", ., "]", "(https://rahulan-c.github.io/lichess4545-stats/reports/stats_lwu1800_s", ., ".html)")
}

# Make sure all completed season vectors are the same length
most_completed <- max(c(length(completed_4545), 
                      length(completed_lwopen), 
                      length(completed_lwu1800)))

if(length(completed_4545) < most_completed){
  completed_4545 <- c(completed_4545, rep("", most_completed - length(completed_4545)))
}

if(length(completed_lwopen) < most_completed){
  completed_lwopen <- c(completed_lwopen, rep("", most_completed - length(completed_lwopen)))
}

if(length(completed_lwu1800) < most_completed){
  completed_lwu1800 <- c(completed_lwu1800, rep("", most_completed - length(completed_lwu1800)))
}

# Make league cols empty if there are no completed seasons
if(any_4545 == F){completed_4545 <- rep("", most_completed)}
if(any_lwopen == F){completed_lwopen <- rep("", most_completed)}
if(any_lwu1800 == F){completed_lwu1800 <- rep("", most_completed)}

# Construct and show table of league reports by season
completed <- tibble("team4545" = completed_4545,
                    "lwopen" = completed_lwopen,
                    "lwu1800" = completed_lwu1800)
knitr::kable(completed, format = "simple", col.names = c("Lichess4545 League", "Lichess LoneWolf (Open)", "Lichess LoneWolf (U1800)"))

```

## Recent updates

Date | Description
:--- | :----------
2021-08-09 | Revisions made to the treatment of banned players and some plots/tables. Added two new awards (Rookie and Egalitarian), season forfeit rates, and several explanatory footnotes.
2021-08-04 | Updates; first full set of season reports published.
2021-08-02 | Updates; first set of season reports republished.
2021-07-30 | First reports published.


## Coming soon

Watch this space!

**Expanding the site** 

- All-time 4545 and LoneWolf stats and records `in progress`
- Allowing users to search for mentions across all reports
- Stats for other Lichess4545 community leagues such as Rapid Battle and Series

**Extending or improving the season stats reports**
 
- Images of knight/pawn checkmates `in progress`
- Which game(s) stayed in "theory" the longest? `in progress`
- Matches that went to the wire `in progress`
- Players that ended up with more time than they began with
- Interesting endgames
- Improved (more exhaustive) analysis of gambits and gambit-loving players





*`r paste0("This page was last updated at ", format(Sys.time(), '%X %Z'), " on ", format(Sys.time(), '%a %d %b %Y'))`.*
