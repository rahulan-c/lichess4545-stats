---
title: "Season stats and awards"
description: |
  Winners, stats, and awards by league and season
output: distill::distill_article
site: distill::distill_website
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
if (!require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse, knitr)
```



```{r season_reports_tbl}

# Identify all seasons for which stats reports have been compiled

reports_path <- paste0(here::here(), "/docs/reports/")

# 4545
completed_4545 <- list.files(path = reports_path, pattern = "^stats_4545(.*)\\.html$") 
any_4545 <- ifelse(length(completed_4545) > 0, T, F)
if(length(completed_4545) > 0){
  completed_4545 <- completed_4545 %>% 
    str_remove_all("stats_4545_s") %>% 
    str_remove_all("\\.html") %>% 
    sort(decreasing = T) %>% 
    paste0("[Season ", ., "]", "(https://rahulan-c.github.io/lichess4545-stats/reports/stats_4545_s", ., ".html)")
}

# LW Open
completed_lwopen <- list.files(path = reports_path, pattern = "^stats_lwopen(.*)\\.html$")
any_lwopen <- ifelse(length(completed_lwopen) > 0, T, F)
if(length(completed_lwopen) > 0){
  completed_lwopen <- completed_lwopen %>% 
    str_remove_all("stats_lwopen_s") %>% 
    str_remove_all("\\.html") %>% 
    sort(decreasing = T) %>% 
    paste0("[Season ", ., "]", "(https://rahulan-c.github.io/lichess4545-stats/reports/stats_lwopen_s", ., ".html)")
}

# LW U1800
completed_lwu1800 <- list.files(path = reports_path, pattern = "^stats_lwu1800(.*)\\.html$")
any_lwu1800 <- ifelse(length(completed_lwu1800) > 0, T, F)
if(length(completed_lwu1800) > 0){
 completed_lwu1800 <- completed_lwu1800 %>%  
   str_remove_all("stats_lwu1800_s") %>% 
   str_remove_all("\\.html") %>% 
   sort(decreasing = T) %>% 
   paste0("[Season ", ., "]", "(https://rahulan-c.github.io/lichess4545-stats/reports/stats_lwu1800_s", ., ".html)")
}

# Chess960
completed_960 <- list.files(path = reports_path, pattern = "^stats_chess960(.*)\\.html$")
any_960 <- ifelse(length(completed_960) > 0, T, F)
if(length(completed_960) > 0){
 completed_960 <- completed_960 %>%  
   str_remove_all("stats_chess960_s") %>% 
   str_remove_all("\\.html") %>% 
   sort(decreasing = T) %>% 
   paste0("[Season ", ., "]", "(https://rahulan-c.github.io/lichess4545-stats/reports/stats_chess960_s", ., ".html)")
}



# Make sure all completed season vectors are the same length
most_completed <- max(c(length(completed_4545), 
                      length(completed_lwopen), 
                      length(completed_lwu1800),
                      length(completed_960)))

if(length(completed_4545) < most_completed){
  completed_4545 <- c(completed_4545, rep("", most_completed - length(completed_4545)))
}

if(length(completed_lwopen) < most_completed){
  completed_lwopen <- c(completed_lwopen, rep("", most_completed - length(completed_lwopen)))
}

if(length(completed_lwu1800) < most_completed){
  completed_lwu1800 <- c(completed_lwu1800, rep("", most_completed - length(completed_lwu1800)))
}

if(length(completed_960) < most_completed){
  completed_960 <- c(completed_960, rep("", most_completed - length(completed_960)))
}


# Make league cols empty if there are no completed seasons
if(any_4545 == F){completed_4545 <- rep("", most_completed)}
if(any_lwopen == F){completed_lwopen <- rep("", most_completed)}
if(any_lwu1800 == F){completed_lwu1800 <- rep("", most_completed)}
if(any_960 == F){completed_960 <- rep("", most_completed)}

# Construct and show table of league reports by season
completed <- tibble("team4545" = completed_4545,
                    "lwopen" = completed_lwopen,
                    "lwu1800" = completed_lwu1800,
                    "chess960" = completed_960)

knitr::kable(completed, format = "simple", 
             col.names = c("4545 / Team", 
                           "LW Open", 
                           "LW U1800",
                           "Chess960"))

```

### Notes

- Most stats and awards in the season reports are based on *played* games, and therefore ignore games that were forfeited or not played for any reason. For example, if a player achieved six played wins plus a forfeit win in a season, only the six played wins would be recognised, so the player's overall season record would be assumed to be 6/6, not 7/7.
- Note that for the 4545 reports, the chart that shows the positions of the final top three teams over the course of the season ([example](https://rahulan-c.github.io/lichess4545-stats/reports/stats_4545_s29.html#How_the_title_race_played_out)) is retroactively calculated from the final confirmed set of match results for the season. In other words, it doesn't necessarily show each team's position *at the time each round happened*, and it won't show the effect of any Lichess fair play decisions on the standings either.
- Most of the LoneWolf season reports are likely to contain potentially wrong or misleading information related to **gambits**. This is because the original data and functions that I used for computing the gambit stats had significant errors, and although I fixed these problems in December 2021, since then I've only managed to republish the season reports for the 4545 league (except seasons 1 and 12)...which means that most of the LW reports haven't been corrected yet (in this respect). The reports for the LW seasons completed since Jan 2022 are fine  
- I consider any account that's been banned by Lichess for ToS violations to be ineligible for any published season award, even if the account was only banned after the relevant season report was first published on the site. This position is reflected in the compiled all-seasons awards table, where all currently ineligible players are scrubbed every time the table is refreshed, but you may still see ineligible players listed as receiving awards in individual season reports. 